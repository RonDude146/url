<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Safety Checker - Secure Web Browsing Tool</title>
    <meta name="description" content="Professional URL safety checker using Google Safe Browsing and VirusTotal APIs">
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    
    <!-- React from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Your App Styles -->
    <link href="src/App.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'heading': ['Poppins', 'sans-serif'],
                        'body': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>

    <!-- Your React App -->
    <script type="text/babel">
        const { useState, useRef } = React;

        function App() {
            const [url, setUrl] = useState("");
            const [isLoading, setIsLoading] = useState(false);
            const [results, setResults] = useState(null);
            const [error, setError] = useState(null);
            const [toast, setToast] = useState({ show: false, message: "" });
            const inputRef = useRef(null);

            const showToast = (message) => {
                setToast({ show: true, message });
                window.clearTimeout(showToast._t);
                showToast._t = window.setTimeout(() => setToast({ show: false, message: "" }), 2200);
            };

            const handleKeyPress = (event) => {
                if (event.key === "Enter") {
                    checkURL();
                }
            };

            const checkURL = async () => {
                const urlToCheck = url.trim();
                if (!urlToCheck) {
                    setError("Please enter a URL to check");
                    return;
                }
                
                setError(null);
                setResults(null);
                setIsLoading(true);

                try {
                    const apiEndpoint = window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1"
                        ? "http://localhost:5000/check"
                        : "/check";

                    const response = await fetch(apiEndpoint, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ url: urlToCheck }),
                    });

                    const data = await response.json();
                    if (!response.ok) {
                        throw new Error(data.error || `HTTP ${response.status}`);
                    }
                    setResults(data);
                } catch (error) {
                    console.error("Error checking URL:", error);
                    setError(`Failed to check URL: ${error.message}`);
                } finally {
                    setIsLoading(false);
                }
            };

            const getStatusIcon = (status) => {
                const icons = {
                    safe: "fas fa-shield-check",
                    suspicious: "fas fa-exclamation-triangle",
                    malicious: "fas fa-skull-crossbones",
                    unknown: "fas fa-question-circle",
                };
                return icons[status] || icons.unknown;
            };

            const getStatusColor = (status) => {
                const colors = {
                    safe: "status-safe glow-safe",
                    suspicious: "status-suspicious glow-suspicious",
                    malicious: "status-malicious glow-malicious",
                    unknown: "status-unknown",
                };
                return colors[status] || colors.unknown;
            };

            const copyUrl = async () => {
                try {
                    await navigator.clipboard.writeText(results?.url || "");
                    showToast("URL copied");
                } catch {}
            };

            const copyJSON = async () => {
                try {
                    await navigator.clipboard.writeText(JSON.stringify(results, null, 2));
                    showToast("JSON copied");
                } catch {}
            };

            const hasValue = url.length > 0;

            return (
                <div className="min-h-screen">
                    {/* Header / Brand */}
                    <header className="py-5 px-4">
                        <div className="container mx-auto">
                            <div className="rounded-2xl px-4 py-3 flex items-center gap-3 bg-white/5 backdrop-blur-xl border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.3)]">
                                <i className="fas fa-shield-alt text-xl text-indigo-300"></i>
                                <h1 className="text-lg md:text-xl font-bold gradient-text font-heading text-pretty">URL Safety Checker</h1>
                            </div>
                        </div>
                    </header>

                    {/* Hero title */}
                    <div className="px-4 pt-6 text-center">
                        <div className="float-animation">
                            <h2 className="text-4xl md:text-5xl font-extrabold mb-3 font-heading gradient-text">
                                Scan URLs with Confidence
                            </h2>
                            <p className="text-base md:text-lg text-slate-300">
                                Protect yourself from malicious websites using trusted security services
                            </p>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="container mx-auto px-4 py-8 max-w-6xl">
                        <div className="max-w-4xl mx-auto">
                            {/* URL Input Card */}
                            <div className="glass-card p-8 mb-8 hover:shadow-blue-500/20">
                                <div className="text-center mb-6">
                                    <h3 className="text-3xl font-bold gradient-text mb-3">Enter URL to Check</h3>
                                    <p className="text-slate-300 text-lg neon-text-bright">We'll scan the URL using multiple security services</p>
                                </div>
                                
                                <div className="flex flex-col md:flex-row gap-4 max-w-4xl mx-auto">
                                    <div className={`flex-1 input-wrap ${hasValue ? 'has-value' : ''}`}>
                                        <label className="float-label">
                                            https://example.com
                                        </label>
                                        <input 
                                            ref={inputRef}
                                            type="text" 
                                            value={url}
                                            onChange={(e) => setUrl(e.target.value)}
                                            onKeyPress={handleKeyPress}
                                            className="input-premium w-full text-base"
                                            aria-label="URL to check"
                                        />
                                    </div>
                                    <button 
                                        onClick={checkURL}
                                        disabled={isLoading}
                                        className="btn-premium min-w-[150px] active:scale-95"
                                        aria-label="Check URL"
                                    >
                                        {isLoading ? (
                                            <>
                                                <div className="loading-radar w-5 h-5 mr-2" aria-hidden="true"></div>
                                                Checking...
                                            </>
                                        ) : (
                                            <>
                                                <i className="fas fa-search mr-2"></i>Check URL
                                            </>
                                        )}
                                    </button>
                                </div>
                                
                                <div className="mt-4 text-center">
                                    <p className="text-white opacity-75 text-sm">
                                        <i className="fas fa-info-circle mr-1"></i>
                                        Powered by Google Safe Browsing and VirusTotal APIs
                                    </p>
                                </div>
                            </div>

                            {/* Loading State */}
                            {isLoading && (
                                <div className="glass-card p-8 mb-8 text-center">
                                    <div className="loading-radar mx-auto mb-6"></div>
                                    <h3 className="text-2xl font-bold gradient-text mb-3">Analyzing URL...</h3>
                                    <p className="text-slate-300 text-lg neon-text-bright">This may take a few seconds</p>
                                    <div className="mt-4">
                                        <div className="flex justify-center space-x-8 text-slate-300">
                                            <div className="pulse-animation neon-text-bright flex items-center">
                                                <i className="fab fa-google text-blue-400 mr-2"></i> Google Safe Browsing
                                            </div>
                                            <div className="pulse-animation neon-text-bright flex items-center" style={{animationDelay: '1s'}}>
                                                <i className="fas fa-virus text-red-400 mr-2"></i> VirusTotal
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Error State */}
                            {error && (
                                <div className="bg-red-50 border border-red-200 rounded-2xl p-8 text-center mb-8">
                                    <i className="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                                    <h3 className="text-xl font-semibold text-red-800 mb-2">Error</h3>
                                    <p className="text-red-600">{error}</p>
                                </div>
                            )}

                            {/* Results */}
                            {results && (
                                <div className="space-y-6">
                                    {/* Main Result Card */}
                                    <div className={`result-card rounded-2xl p-8 shadow-lg bg-gradient-to-r ${results.status === 'safe' ? 'from-green-500/20 to-emerald-500/20' : results.status === 'suspicious' ? 'from-yellow-500/20 to-orange-500/20' : results.status === 'malicious' ? 'from-red-500/20 to-pink-500/20' : 'from-gray-500/20 to-slate-500/20'}`}>
                                        <div className="flex items-center justify-between mb-4">
                                            <div className="flex items-center">
                                                <div className="text-4xl mr-4">
                                                    <i className={`${getStatusIcon(results.status)} ${getStatusColor(results.status)}`}></i>
                                                </div>
                                                <div>
                                                    <h3 className={`text-2xl font-bold ${getStatusColor(results.status)}`}>
                                                        {results.status.toUpperCase()}
                                                    </h3>
                                                    <p className="text-gray-600">{results.reason}</p>
                                                </div>
                                            </div>
                                            <div className="text-right">
                                                <p className="text-sm text-gray-500">Checked URL:</p>
                                                <p className="font-mono text-sm bg-gray-100 px-2 py-1 rounded break-all max-w-xs">
                                                    {results.url}
                                                </p>
                                                <div className="mt-2 space-x-2">
                                                    <button 
                                                        onClick={copyUrl}
                                                        className="text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600"
                                                    >
                                                        <i className="fas fa-copy mr-1"></i>Copy URL
                                                    </button>
                                                    <button 
                                                        onClick={copyJSON}
                                                        className="text-xs bg-purple-500 text-white px-2 py-1 rounded hover:bg-purple-600"
                                                    >
                                                        <i className="fas fa-code mr-1"></i>Copy JSON
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Detailed Results */}
                                    <div className="grid md:grid-cols-2 gap-6">
                                        {/* Google Safe Browsing Card */}
                                        <div className="bg-white/10 backdrop-blur-xl border border-white/20 rounded-xl p-6 shadow-lg">
                                            <div className="flex items-center mb-4">
                                                <i className="fab fa-google text-2xl text-blue-400 mr-3"></i>
                                                <h4 className="text-xl font-semibold gradient-text">Google Safe Browsing</h4>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">Status:</span>
                                                    <span className={`font-semibold ${results.details.google_safebrowsing.error ? 'text-red-400' : 'text-green-400'}`}>
                                                        {results.details.google_safebrowsing.error ? 'Error' : 'Success'}
                                                    </span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">Threats Found:</span>
                                                    <span className="font-semibold text-slate-200">
                                                        {results.details.google_safebrowsing.matches ? results.details.google_safebrowsing.matches.length : 0}
                                                    </span>
                                                </div>
                                                {results.details.google_safebrowsing.matches && results.details.google_safebrowsing.matches.length > 0 && (
                                                    <div className="mt-3">
                                                        <div className="text-sm text-slate-300">
                                                            <strong>Threat Types:</strong> {results.details.google_safebrowsing.matches.map(match => match.threatType).join(', ')}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>

                                        {/* VirusTotal Card */}
                                        <div className="bg-white/10 backdrop-blur-xl border border-white/20 rounded-xl p-6 shadow-lg">
                                            <div className="flex items-center mb-4">
                                                <i className="fas fa-virus text-2xl text-red-400 mr-3"></i>
                                                <h4 className="text-xl font-semibold gradient-text">VirusTotal</h4>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">Status:</span>
                                                    <span className={`font-semibold ${results.details.virustotal.error ? 'text-red-400' : 'text-green-400'}`}>
                                                        {results.details.virustotal.error ? 'Error' : 'Success'}
                                                    </span>
                                                </div>
                                                {results.details.virustotal.data?.attributes?.stats && (
                                                    <div className="grid grid-cols-2 gap-2 text-sm">
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-300">Malicious:</span>
                                                            <span className="font-semibold text-red-400">{results.details.virustotal.data.attributes.stats.malicious || 0}</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-300">Suspicious:</span>
                                                            <span className="font-semibold text-yellow-400">{results.details.virustotal.data.attributes.stats.suspicious || 0}</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-300">Clean:</span>
                                                            <span className="font-semibold text-green-400">{results.details.virustotal.data.attributes.stats.harmless || 0}</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-300">Undetected:</span>
                                                            <span className="font-semibold text-gray-400">{results.details.virustotal.data.attributes.stats.undetected || 0}</span>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="py-8 mt-16">
                        <div className="container mx-auto px-4 text-center text-white/75">
                            <p>&copy; 2024 URL Safety Checker. Built for educational purposes.</p>
                            <p className="mt-2 text-sm">
                                <i className="fas fa-graduation-cap mr-1"></i>
                                College Project - Web Security & API Integration
                            </p>
                        </div>
                    </footer>

                    {/* Toast Notification */}
                    {toast.show && (
                        <div className="snackbar">
                            <i className="fas fa-check-circle text-green-400"></i>
                            <span>{toast.message}</span>
                        </div>
                    )}
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>